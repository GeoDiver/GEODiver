!function(e,t,a){var o=function(e,a){"use strict";e.extend(!0,a.defaults,{dom:"<'hiddensearch'f'>tr<'table-footer'lip'>",renderer:"material"}),e.extend(a.ext.classes,{sWrapper:"dataTables_wrapper",sFilterInput:"form-control input-sm",sLengthSelect:"form-control input-sm"}),a.ext.renderer.pageButton.material=function(o,i,n,l,r,s){var d,c,p,u=new a.Api(o),m=o.oClasses,f=o.oLanguage.oPaginate,g=0,h=function(t,a){var i,l,p,b,v=function(t){t.preventDefault(),e(t.currentTarget).hasClass("disabled")||u.page(t.data.action).draw(!1)};for(i=0,l=a.length;l>i;i++)if(b=a[i],e.isArray(b))h(t,b);else{switch(d="",c="",b){case"first":d=f.sFirst,c=b+(r>0?"":" disabled");break;case"previous":d='<i class="material-icons">chevron_left</i>',c=b+(r>0?"":" disabled");break;case"next":d='<i class="material-icons">chevron_right</i>',c=b+(s-1>r?"":" disabled");break;case"last":d=f.sLast,c=b+(s-1>r?"":" disabled")}d&&(p=e("<li>",{"class":m.sPageButton+" "+c,id:0===n&&"string"==typeof b?o.sTableId+"_"+b:null}).append(e("<a>",{href:"#","aria-controls":o.sTableId,"data-dt-idx":g,tabindex:o.iTabIndex}).html(d)).appendTo(t),o.oApi._fnBindAction(p,{action:b},v),g++)}};try{p=e(t.activeElement).data("dt-idx")}catch(b){}h(e(i).empty().html('<ul class="material-pagination"/>').children("ul"),l),p&&e(i).find("[data-dt-idx="+p+"]").focus()},a.TableTools&&(e.extend(!0,a.TableTools.classes,{container:"DTTT btn-group",buttons:{normal:"btn btn-default",disabled:"disabled"},collection:{container:"DTTT_dropdown dropdown-menu",buttons:{normal:"",disabled:"disabled"}},print:{info:"DTTT_print_info"},select:{row:"active"}}),e.extend(!0,a.TableTools.DEFAULTS.oTags,{collection:{container:"ul",button:"li",liner:"a"}}))};"function"==typeof define&&define.amd?define(["jquery","datatables"],o):"object"==typeof exports?o(require("jquery"),require("datatables")):jQuery&&o(jQuery,jQuery.fn.dataTable)}(window,document),!function(e,t){var a=/[<>&\r\n"']/gm,o={"<":"lt;",">":"gt;","&":"amp;","\r":"#13;","\n":"#10;",'"':"quot;","'":"#39;"};e.extend({fileDownload:function(i,n){function l(){var t=m.cookieValue;"string"==typeof t&&(t=t.toLowerCase());var a=m.cookieName.toLowerCase()+"="+t;if(document.cookie.toLowerCase().indexOf(a)>-1){v.onSuccess(i);var o=m.cookieName+"=; path="+m.cookiePath+"; expires="+new Date(0).toUTCString()+";";return m.cookieDomain&&(o+=" domain="+m.cookieDomain+";"),document.cookie=o,void s(!1)}if(w||x)try{var n=w?w.document:r(x);if(n&&null!==n.body&&n.body.innerHTML.length){var d=!0;if(_&&_.length){var c=e(n.body).contents().first();try{c.length&&c[0]===_[0]&&(d=!1)}catch(p){if(!p||-2146828218!=p.number)throw p;d=!0}}if(d)return void setTimeout(function(){v.onFail(n.body.innerHTML,i),s(!0)},100)}}catch(u){return v.onFail("",i,u),void s(!0)}setTimeout(l,m.checkInterval)}function r(e){var t=e[0].contentWindow||e[0].contentDocument;return t.document&&(t=t.document),t}function s(e){setTimeout(function(){w&&(p&&w.close(),c&&w.focus&&(w.focus(),e&&w.close()))},0)}function d(e){return e.replace(a,function(e){return"&"+o[e]})}var c,p,u,m=e.extend({preparingMessageHtml:null,failMessageHtml:null,androidPostUnsupportedMessageHtml:"Unfortunately your Android browser doesn't support this type of file download. Please try again with a different browser.",dialogOptions:{modal:!0},prepareCallback:function(e){},successCallback:function(e){},failCallback:function(e,t,a){},httpMethod:"GET",data:null,checkInterval:100,cookieName:"fileDownload",cookieValue:"true",cookiePath:"/",cookieDomain:null,popupWindowTitle:"Initiating file download...",encodeHTMLEntities:!0},n),f=new e.Deferred,g=(navigator.userAgent||navigator.vendor||t.opera).toLowerCase();/ip(ad|hone|od)/.test(g)?c=!0:-1!==g.indexOf("android")?p=!0:u=/avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|playbook|silk|iemobile|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(g)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(g.substr(0,4));var h=m.httpMethod.toUpperCase();if(p&&"GET"!==h&&m.androidPostUnsupportedMessageHtml)return e().dialog?e("<div>").html(m.androidPostUnsupportedMessageHtml).dialog(m.dialogOptions):alert(m.androidPostUnsupportedMessageHtml),f.reject();var b=null,v={onPrepare:function(t){m.preparingMessageHtml?b=e("<div>").html(m.preparingMessageHtml).dialog(m.dialogOptions):m.prepareCallback&&m.prepareCallback(t)},onSuccess:function(e){b&&b.dialog("close"),m.successCallback(e),f.resolve(e)},onFail:function(t,a,o){b&&b.dialog("close"),m.failMessageHtml&&e("<div>").html(m.failMessageHtml).dialog(m.dialogOptions),m.failCallback(t,a,o),f.reject(t,a)}};v.onPrepare(i),null!==m.data&&"string"!=typeof m.data&&(m.data=e.param(m.data));var x,w,y,_;if("GET"===h){if(null!==m.data){var $=i.indexOf("?");-1!==$?"&"!==i.substring(i.length-1)&&(i+="&"):i+="?",i+=m.data}c||p?(w=t.open(i),w.document.title=m.popupWindowTitle,t.focus()):u?t.location(i):x=e("<iframe>").hide().prop("src",i).appendTo("body")}else{var P="";null!==m.data&&e.each(m.data.replace(/\+/g," ").split("&"),function(){var e=this.split("="),t=e[0];e.shift();var a=e.join("=");e=[t,a];var o=m.encodeHTMLEntities?d(decodeURIComponent(e[0])):decodeURIComponent(e[0]);if(o){var i=m.encodeHTMLEntities?d(decodeURIComponent(e[1])):decodeURIComponent(e[1]);P+='<input type="hidden" name="'+o+'" value="'+i+'" />'}}),u?(_=e("<form>").appendTo("body"),_.hide().prop("method",m.httpMethod).prop("action",i).html(P)):(c?(w=t.open("about:blank"),w.document.title=m.popupWindowTitle,y=w.document,t.focus()):(x=e("<iframe style='display: none' src='about:blank'></iframe>").appendTo("body"),y=r(x)),y.write("<html><head></head><body><form method='"+m.httpMethod+"' action='"+i+"'>"+P+"</form>"+m.popupWindowTitle+"</body></html>"),_=e(y).find("form")),_.submit()}setTimeout(l,m.checkInterval);var D=f.promise();return D.abort=function(){s(),x.remove()},D}})}(jQuery,this);var GD;GD||(GD={}),function(){GD.setUpValidatorDefaults=function(){$.validator.addMethod("geoDb",function(e){return/^GDS\d\d\d\d?$/.test(e)},"Please enter a valid GEO dataset accession number (in the format GDSxxxx)."),$.validator.setDefaults({errorClass:"invalid",validClass:"valid",errorPlacement:function(e,t){$(t).closest("form").find("label[for='"+t.attr("id")+"']").attr("data-error",e.text())}})},GD.loadGeoDbValidation=function(){"use strict";$("#load_geo_db").validate({rules:{geo_db:{geoDb:!0,required:!0}},submitHandler:function(e){var t=$("input[name=geo_db]").val();$("#model_header_text").text("Loading GEO Dataset: "+t),$("#model_text").text("This should take a few seconds. Please leave this page open"),$("#loading_modal").openModal({dismissible:!1}),$.ajax({type:"POST",url:"/load_geo_db",data:$("#load_geo_db").serialize(),success:function(e){$(".card-action").remove(),$("#results_section").empty(),$(e).insertAfter("#load_geo_card"),$("#geo_db_summary").html(e),$("#geo_db_summary").show(),$(".adv_param_collapsible").collapsible(),$("input:radio[name=factor]:first").attr("checked",!0),$("#"+$("input:radio[name=factor]:first").attr("id")+"_select").show(),GD.addFactorToggle(),$("select").material_select(),GD.addDataSetInfo(),GD.analyseValidation(),$("#loading_modal").closeModal()},error:function(e,t){GD.ajaxError(e,t)}})}})},GD.analyseValidation=function(){"use strict";$("#analyse").validate({rules:{},submitHandler:function(e){var t=$("input[name=geo_db]").val();$("#model_header_text").text("Analysing GEO Dataset: "+t),$("#model_text").text("This should take a few minutes. Please leave this page open"),$("#loading_modal").openModal({dismissible:!1}),$.ajax({type:"POST",url:"/analyse",data:$("#analyse").serialize(),success:function(e){$("#results_section").html(e),$("#results_section").show(),$("#results_tabs").tabs(),GD.createPlots(),$(".materialboxed").materialbox(),$("#loading_modal").closeModal()},error:function(e,t){GD.ajaxError(e,t)}})}})},GD.geneExpressionAjax=function(e,t){$("#model_header_text").text("Loading Graphics for Gene: "+t),$("#model_text").text("This should take a few seconds. Please leave this page open"),$("#loading_modal").openModal({dismissible:!1});var a=e.closest(".results_card").data("results_id"),o=e.closest(".results_card").data("geo_db");$.ajax({type:"POST",url:"/gene_expression_url",data:{gene_id:t,result_id:a,geo_db:o},success:function(a){e.addClass("parent"),e.after('<tr class="child" id="'+t+'ChildRow"><td colspan="8"><div id="'+t+'Plot"></div></td></tr>'),GD.createExpressionPlot(a,t),$("#loading_modal").closeModal()},error:function(e,t){GD.ajaxError(e,t)}})},GD.interactionNetworkAjax=function(e,t){$("#model_header_text").text("Loading Graphics for GeneSet: "+t),$("#model_text").text("This should take a few seconds. Please leave this page open"),$("#loading_modal").openModal({dismissible:!1});var a=e.closest(".results_card").data("results_id"),o=e.closest(".results_card").data("geo_db");$.ajax({type:"POST",url:"/interaction",data:{path_id:t,result_id:a,geo_db:o},success:function(t){e.addClass("parent"),e.after(t),$("#loading_modal").closeModal()},error:function(e,t){GD.ajaxError(e,t)}})},GD.ajaxError=function(e,t){var a;500==e.status||400==e.status?(a=e.responseText,$("#results_section").show(),$("#results_section").html(a),$("#loading_modal").closeModal()):(a=e.responseText,$("#results_section").show(),$("#results_section").html("There seems to be an unidentified Error."),$("#loading_modal").closeModal())},GD.loadPcRedrawValidation=function(){$("#pca_redraw").validate({rules:{},submitHandler:function(e,t){t.preventDefault(),$("#principle_plot").empty();var a=$("select[name=PCoption1]").val(),o=$("select[name=PCoption2]").val(),i=$("select[name=PCoption3]").val(),n=$("#overview").data("overview-json");$.getJSON(n,function(e){GD.createPCAScatterPlot(e.pcdata,a,o,i)})}})},GD.createPlots=function(){var e=$("#overview").data("overview-json");$.getJSON(e,function(e){pcaPlot=GD.createPCAPLOT(e.pc.cumVar,e.pc.expVar,e.pc.pcnames),pcaScatterPlot=GD.createPCAScatterPlot(e.pcdata,"PC1","PC2","PC3"),GD.initialiatizePcaScatterPlot(e.pc.pcnames),$("select").material_select()});var t=$("#DGEA").data("dgea-json");$.getJSON(t,function(e){volcanoPlot=GD.createVolcanoPlot(e.vol.logFC,e.vol.pVal,e.vol.genes),GD.initializeToptable(e.tops,"dgea-top-table","dgea-top-table-wrapper")});var a=$("#GSEA").data("gsea-json");$.getJSON(a,function(e){GD.initializeToptable(e.tops,"gsea-top-table","gsea-top-table-wrapper")}),window.onresize=function(){Plotly.Plots.resize(pcaPlot),Plotly.Plots.resize(volcanoPlot),Plotly.Plots.resize(pcaScatterPlot)}},GD.createPCAScatterPlot=function(e,t,a,o){var i,n,l,r,s,d,c;return"undefined"==typeof o?(i={x:e[t+".Group1"],y:e[a+".Group1"],text:e.Group1,type:"scatter",mode:"markers",name:"Group1",marker:{symbol:"circle"}},n={x:e[t+".Group2"],y:e[a+".Group2"],text:e.Group2,type:"scatter",mode:"markers",name:"Group2",marker:{symbol:"square"}},l=[i,n],r={xaxis:{title:t},yaxis:{title:a}},s=100,d=Plotly.d3.select("#principle_plot").style({width:s+"%","margin-left":(100-s)/2+"%"}),c=d.node(),Plotly.newPlot(c,l,r),c):(i={x:e[t+".Group1"],y:e[a+".Group1"],z:e[o+".Group1"],text:e.Group1,type:"scatter3d",mode:"markers",name:"Group1",marker:{symbol:"circle"}},n={x:e[t+".Group2"],y:e[a+".Group2"],z:e[o+".Group2"],text:e.Group2,type:"scatter3d",mode:"markers",name:"Group2",marker:{symbol:"square"}},l=[i,n],r={xaxis:{title:t},yaxis:{title:a},zaxis:{title:o}},s=100,d=Plotly.d3.select("#principle_plot").style({width:s+"%","margin-left":(100-s)/2+"%"}),c=d.node(),Plotly.newPlot(c,l,r),c)},GD.createPCAPLOT=function(e,t,a){var o={x:a,y:e,type:"scatter",name:"Cumulative PCA"},i={x:a,y:t,type:"scatter",name:"PCA"},n=[o,i],l={legend:{x:0,y:100,traceorder:"normal"}},r=100,s=Plotly.d3.select("#PCA_plot").style({width:r+"%","margin-left":(100-r)/2+"%"}),d=s.node();return Plotly.newPlot(d,n,l),d},GD.createVolcanoPlot=function(e,t,a){var o={x:e,y:t,text:a,mode:"markers",type:"scatter",name:"volcano_plot",marker:{size:7.5}},i=[o],n={xaxis:{title:"Log 2 Fold Change"},yaxis:{title:"-Log10(P Value)"},hovermode:"closest"},l=100,r=Plotly.d3.select("#volcano_plot").style({width:l+"%","margin-left":(100-l)/2+"%"}),s=r.node();return Plotly.newPlot(s,i,n),s},GD.createExpressionPlot=function(e,t){var a={x:e.group1.x,y:e.group1.y,type:"bar",name:"Group 1"},o={x:e.group2.x,y:e.group2.y,type:"bar",name:"Group 2"},i=[a,o],n={barmode:"group",xaxis:{title:"Sample",tickangle:-40,position:-.5},yaxis:{title:"Expression"}},l=100,r=Plotly.d3.select("#"+t+"Plot").style({width:l+"%","margin-left":(100-l)/2+"%"}),s=r.node();Plotly.newPlot(s,i,n),window.onresize=function(){Plotly.Plots.resize(s)}},GD.initializeToptable=function(e,t,a){e=GD.addPlotIconToTopTable(e),$("#"+t).dataTable({oLanguage:{sStripClasses:"",sSearch:"",sSearchPlaceholder:"Enter Keywords Here",sInfo:"_START_ -_END_ of _TOTAL_",sLengthMenu:'<span>Rows per page:</span><select class="browser-default"><option value="10">10</option><option value="20">20</option><option value="30">30</option><option value="40">40</option><option value="50">50</option><option value="-1">All</option></select></div>'},data:e,order:[[5,"asc"]],bAutoWidth:!1}),GD.makePlotIconClickable(a),$("#"+a).on("click",".search-toggle",function(){"none"==$(".hiddensearch").css("display")?$(".hiddensearch").slideDown():$(".hiddensearch").slideUp()}),$("#"+a).on("click",".download-top-table",function(){return $("#model_header_text").text("Creating Download Link"),$("#model_text").text("This should take a few seconds. Please leave this page open"),$("#loading_modal").openModal({dismissible:!1}),$.fileDownload($(this).attr("href"),{successCallback:function(e){$("#loading_modal").closeModal()},failCallback:function(e,t){$("#loading_modal").closeModal()}}),!1})},GD.addPlotIconToTopTable=function(e){return $.each(e,function(e,t){t.push('<i class="material-icons child-row-chart light-blue-text text-darken-3">insert_chart</i>')}),e},GD.makePlotIconClickable=function(e){$("#"+e).on("click",".child-row-chart",function(){var t=$(this).closest("tr"),a=t.children("td:first").text();$("#"+a+"ChildRow").length?$("#"+a+"ChildRow").remove():"dgea-top-table-wrapper"===e?GD.geneExpressionAjax(t,a):"gsea-top-table-wrapper"===e&&GD.interactionNetworkAjax(t,a)})},GD.initialiatizePcaScatterPlot=function(e){$.each(e,function(e,t){$("#PCoption1").append($("<option></option>").attr("value",t).text(t)),$("#PCoption2").append($("<option></option>").attr("value",t).text(t)),$("#PCoption3").append($("<option></option>").attr("value",t).text(t))}),GD.loadPcRedrawValidation()},GD.addFactorToggle=function(){$("input:radio[name=factor]").click(function(){var e="#"+$(this).attr("id")+"_select";"#"+$(".select_factors:visible").attr("id")!==e&&($(".select_factors").hide(),$(e).show())})},GD.addDataSetInfo=function(){var e=$("input[name=geo_db]").val(),t="GeoDiver/DBs/"+e+".json";$.getJSON(t,function(e){$("#dataset_accession").text(e.Accession),$("#dataset_title").text(e.Title),$("#dataset_summary").text(e.Description),$("#dataset_organism").text(e.Sample_Organism),$("#dataset_summary").text(e.Description),$("#dataset_citation").text(e.Reference)})},GD.addUserDropDown=function(){$(".dropdown-button").dropdown({inDuration:300,outDuration:225,hover:!0,belowOrigin:!0,alignment:"right"})}}(),function(e){e(function(){e(".button-collapse").sideNav(),e(".parallax").parallax(),e("select").material_select(),GD.setUpValidatorDefaults(),GD.loadGeoDbValidation(),GD.addUserDropDown()})}(jQuery);