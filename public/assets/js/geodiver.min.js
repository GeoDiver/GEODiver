var GD;GD||(GD={}),function(){GD.createPlots=function(){jsonFile=$("#DGEA").data("results-json"),$.getJSON(jsonFile,function(t){GD.createPCAPLOT(t.pc.cumVar,t.pc.expVar,t.pc.pcnames),GD.createVolcanoPlot(t.vol.logFC,t.vol.pVal)})},GD.createPCAPLOT=function(t,e,a){var o={x:a,y:t,type:"scatter",name:"Cumulative PCA"},n={x:a,y:e,type:"scatter",name:"PCA"},i=[o,n],s={legend:{x:0,y:100,traceorder:"normal",font:{family:"sans-serif",size:12,color:"#000"},bgcolor:"#E2E2E2",bordercolor:"#FFFFFF",borderwidth:2}};Plotly.newPlot("PCA_plot",i,s)},GD.createVolcanoPlot=function(t,e){var a={x:t,y:e,mode:"markers",type:"scatter",name:"volcano_plot",text:["DDR1","RFC2","HSPA6","PAX8","GUCA1A","UBA7","THRA","PTPN21","CCL5","CYP2E1","EPHB3","ESRRA","CYP2A6","SCARB1","TTLL12","LINC00152","WFDC2","MAPK1","MAPK1","ADAM32","SPATA17","PRR22","PRR22","PXK","PXK","VPS18","MSANTD3","SLC46A1","SLC46A1","TIMD4","SLC39A5","ZDHHC11","ATP6V1E2","AFG3L1P","CILP2","CILP2","PIGX","TMEM196","SLC39A13","BEST4","AK9","CORO6","TMEM106A","TMEM106A","ALG10","ALG10","TTC39C","NEXN","C15orf40","RAX2","MFAP3","EYA3","GIMAP1","GIMAP1","GIMAP1","KLK8","CCDC65","CCDC65","FAM122C","FAM122C","CFAP53","CFAP53","ARMCX4","RBBP6","CENPBD1","TRIOBP","TRIOBP","CATSPER1","HOXD4","GSC","SP7","PDE7A","CNOT7","CRYZL1","PRSS33","PRSS33","C19orf26","C19orf26","MCMDC2","TIRAP","LEAP2","MSI2","SCIN","SCIN","CTCFL","C4orf33","C4orf33","C4orf33","ZNF333","TVP23C","RDH10","RDH10","SRSF12","FAM71A","FAM71A","GAPT","FLJ30901","ERICH5","ERICH5","CCDC185"],marker:{size:7.5}},o=[a],n={xaxis:{range:[-1.15,1.15]},yaxis:{range:[5,28]},hovermode:"closest",xaxis:{title:"Log 2 Fold Change",titlefont:{family:"Courier New, monospace",size:18,color:"#7f7f7f"}},yaxis:{title:"-Log10(P Value)",titlefont:{family:"Courier New, monospace",size:18,color:"#7f7f7f"}}};Plotly.newPlot("volcano_plot",o,n)},GD.addFactorToggle=function(){$("input:radio[name=factor]").click(function(){var t="#"+$(this).attr("id")+"_select";"#"+$(".select_factors:visible").attr("id")!==t&&($(".select_factors").hide(),$(t).show())})},GD.addDataSetInfo=function(){var t=$("input[name=geo_db]").val(),e="GeoDiver/DBs/"+t+".json";$.getJSON(e,function(t){$("#dataset_accession").text(t.Accession),$("#dataset_title").text(t.Title),$("#dataset_summary").text(t.Description),$("#dataset_organism").text(t.Sample_Organism),$("#dataset_summary").text(t.Description),$("#dataset_citation").text(t.Reference)})},GD.addUserDropDown=function(){$(".dropdown-button").dropdown({inDuration:300,outDuration:225,hover:!0,belowOrigin:!0,alignment:"right"})}}();var inputValidation=function(){"use strict";$("#input").validate({rules:{input:{minlength:5,maxlength:7,required:!0}},errorClass:"invalid",errorPlacement:function(t,e){e.next("label").attr("data-error",t.contents().text())},submitHandler:function(t){var e=$("input[name=geo_db]").val();"/load_geo_db"===$("#input").attr("action")?($("#model_header_text").text("Loading GEO Dataset: "+e),$("#model_text").text("This should take a few seconds. Please leave this page open")):"/"===$("#input").attr("action")&&($("#model_header_text").text("Analysing GEO Dataset: "+e),$("#model_text").text("This should take a few minutes. Please leave this page open")),$("#loading_modal").openModal({dismissible:!1}),ajaxFunction()}})},ajaxFunction=function(){"use strict";$.ajax({type:"POST",url:$("#input").attr("action"),data:$("#input").serialize(),success:function(t){"/load_geo_db"===$("#input").attr("action")?($("#geo_db_summary").html(t),$("#geo_db_summary").show(),$(".adv_param_collapsible").collapsible(),$("#analyse_geo_btn").html('Analyse<i class="material-icons right">send</i>'),$("input:radio[name=factor]:first").attr("checked",!0),$("#"+$("input:radio[name=factor]:first").attr("id")+"_select").show(),GD.addFactorToggle(),$("select").material_select(),GD.addDataSetInfo(),$("#input").attr("action","/analyse"),$("#loading_modal").closeModal()):"/analyse"===$("#input").attr("action")&&($("#results_section").html(t),$("#results_section").show(),$(".materialboxed").materialbox(),$("#results_tabs").tabs(),GD.createPlots(),$("#loading_modal").closeModal())},error:function(t,e){var a;500==t.status||400==t.status?(a=t.responseText,$("#results_section").show(),$("#results_section").html(a),$("#loading_modal").closeModal()):(a=t.responseText,$("#results_section").show(),$("#results_section").html("There seems to be an unidentified Error."),$("#loading_modal").closeModal())}})};!function(t){t(function(){t(".button-collapse").sideNav(),t(".parallax").parallax(),t("select").material_select(),inputValidation(),GD.addUserDropDown()})}(jQuery);